<template><div><h1 id="ğŸª¤-vue-router" tabindex="-1"><a class="header-anchor" href="#ğŸª¤-vue-router"><span>ğŸª¤ vue-router</span></a></h1>
<h2 id="è·¯ç”±çš„ç›¸å…³çŸ¥è¯†ç‚¹" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±çš„ç›¸å…³çŸ¥è¯†ç‚¹"><span>è·¯ç”±çš„ç›¸å…³çŸ¥è¯†ç‚¹</span></a></h2>
<h3 id="å‰ç«¯è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#å‰ç«¯è·¯ç”±"><span>å‰ç«¯è·¯ç”±</span></a></h3>
<blockquote>
<p>å‰ç«¯è·¯ç”±æ˜¯åæ¥å‘å±•åˆ°SPAï¼ˆå•é¡µåº”ç”¨ï¼‰æ—¶æ‰å‡ºç°çš„æ¦‚å¿µã€‚ SPA å°±æ˜¯ä¸€ä¸ªWEBé¡¹ç›®åªæœ‰ä¸€ä¸ª HTML é¡µé¢ï¼Œä¸€æ—¦é¡µé¢åŠ è½½å®Œæˆï¼ŒSPA ä¸ä¼šå› ä¸ºç”¨æˆ·çš„æ“ä½œè€Œè¿›è¡Œé¡µé¢çš„é‡æ–°åŠ è½½æˆ–è·³è½¬ã€‚</p>
</blockquote>
<p>å‰ç«¯è·¯ç”±åœ¨SPAé¡¹ç›®ä¸­æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œé¡µé¢çš„è·³è½¬ã€åˆ·æ–°éƒ½ä¸è·¯ç”±æœ‰å…³ï¼Œé€šè¿‡ä¸åŒçš„urlæ˜¾ç¤ºç›¸åº”çš„é¡µé¢ã€‚</p>
<p>ä¼˜ç‚¹ï¼šå‰åç«¯çš„å½»åº•åˆ†ç¦»ï¼Œä¸åˆ·æ–°é¡µé¢ï¼Œç”¨æˆ·ä½“éªŒè¾ƒå¥½ï¼Œé¡µé¢æŒä¹…æ€§è¾ƒå¥½ã€‚</p>
<h3 id="åç«¯è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#åç«¯è·¯ç”±"><span>åç«¯è·¯ç”±</span></a></h3>
<p>å½“åœ¨åœ°å€æ åˆ‡æ¢ä¸åŒçš„urlæ—¶ï¼Œéƒ½ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥æ”¶å¹¶å“åº”è¿™ä¸ªè¯·æ±‚ï¼Œåœ¨æœåŠ¡ç«¯æ‹¼æ¥å¥½htmlæ–‡ä»¶è¿”å›ç»™é¡µé¢æ¥å±•ç¤ºã€‚</p>
<p>ä¼˜ç‚¹ï¼šå‡è½»äº†å‰ç«¯çš„å‹åŠ›ï¼Œhtmléƒ½ç”±åç«¯æ‹¼æ¥ï¼›</p>
<p>ç¼ºç‚¹ï¼šä¾èµ–äºç½‘ç»œï¼Œç½‘é€Ÿæ…¢ï¼Œç”¨æˆ·ä½“éªŒå¾ˆå·®ï¼Œé¡¹ç›®æ¯”è¾ƒåºå¤§æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å‹åŠ›è¾ƒå¤§ï¼Œ</p>
<p>ä¸èƒ½åœ¨åœ°å€æ è¾“å…¥æŒ‡å®šçš„urlè®¿é—®ç›¸åº”çš„æ¨¡å—ï¼Œå‰åç«¯ä¸åˆ†ç¦»ã€‚</p>
<h3 id="è·¯ç”±æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±æ¨¡å¼"><span>è·¯ç”±æ¨¡å¼</span></a></h3>
<h4 id="hashæ¨¡å¼-å¯¹åº”hashhistory" tabindex="-1"><a class="header-anchor" href="#hashæ¨¡å¼-å¯¹åº”hashhistory"><span>hashæ¨¡å¼ï¼ˆå¯¹åº”HashHistoryï¼‰</span></a></h4>
<ul>
<li>
<p>å‰ç«¯è·¯ç”±çš„è·¯å¾„ç”¨äº•å· # æ‹¼æ¥åœ¨çœŸå® url åé¢çš„æ¨¡å¼ï¼Œä½†æ˜¯ä¼šè¦†ç›–é”šç‚¹å®šä½å…ƒç´ çš„åŠŸèƒ½ï¼Œé€šè¿‡ç›‘å¬ URL çš„å“ˆå¸Œéƒ¨åˆ†å˜åŒ–ï¼Œç›¸åº”åœ°æ›´æ–°é¡µé¢çš„å†…å®¹ã€‚</p>
</li>
<li>
<p>å‰ç«¯è·¯ç”±çš„å¤„ç†å®Œå…¨åœ¨å®¢æˆ·ç«¯è¿›è¡Œï¼Œåœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªä¼šæ”¹å˜ URL ä¸­çš„å“ˆå¸Œéƒ¨åˆ†(äº•å· # åé¢çš„è·¯å¾„)ï¼Œä¸”ä¸ä¼šå‘æœåŠ¡å™¨å‘é€æ–°çš„è¯·æ±‚ï¼Œè€Œæ˜¯è§¦å‘ onhashchange äº‹ä»¶ã€‚</p>
</li>
<li>
<p>hash åªæœ‰#ç¬¦å·ä¹‹å‰çš„å†…å®¹æ‰ä¼šåŒ…å«åœ¨è¯·æ±‚ä¸­è¢«å‘é€åˆ°åç«¯ï¼Œå¦‚æœ nginx æ²¡æœ‰åŒ¹é…å¾—åˆ°å½“å‰çš„ url ä¹Ÿæ²¡å…³ç³»ã€‚hash æ°¸è¿œä¸ä¼šæäº¤åˆ° server ç«¯ã€‚</p>
</li>
<li>
<p>hashå€¼çš„æ”¹å˜ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½•ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æµè§ˆå™¨çš„å›é€€ã€å‰è¿›æŒ‰é’®æ§åˆ¶hashçš„åˆ‡æ¢ã€‚</p>
</li>
<li>
<p>hash è·¯ç”±ä¸ä¼šé€ æˆ 404 é¡µé¢çš„é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰è·¯ç”±ä¿¡æ¯éƒ½åœ¨å®¢æˆ·ç«¯è¿›è¡Œè§£æå’Œå¤„ç†ï¼ŒæœåŠ¡å™¨åªè´Ÿè´£æä¾›åº”ç”¨çš„åˆå§‹ HTML é¡µé¢å’Œé™æ€èµ„æºï¼Œä¸éœ€è¦å…³å¿ƒè·¯ç”±çš„åŒ¹é…é—®é¢˜ã€‚</p>
</li>
</ul>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token comment">// onhashchageäº‹ä»¶ï¼Œå¯ä»¥åœ¨windowå¯¹è±¡ä¸Šç›‘å¬è¿™ä¸ªäº‹ä»¶</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>oldURL<span class="token punctuation">,</span> event<span class="token punctuation">.</span>newURL<span class="token punctuation">)</span>
  <span class="token keyword">let</span> hash <span class="token operator">=</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="historyæ¨¡å¼-å¯¹åº”html5history" tabindex="-1"><a class="header-anchor" href="#historyæ¨¡å¼-å¯¹åº”html5history"><span>historyæ¨¡å¼ ï¼ˆå¯¹åº”HTML5Historyï¼‰</span></a></h4>
<ul>
<li>
<p>æ˜¯ html5 æ–°æ¨å‡ºçš„åŠŸèƒ½ï¼Œæ¯” Hash url æ›´ç¾è§‚</p>
</li>
<li>
<p>åœ¨ history æ¨¡å¼ä¸‹æµè§ˆå™¨åœ¨åˆ·æ–°é¡µé¢æ—¶ï¼Œä¼šæŒ‰ç…§è·¯å¾„å‘é€çœŸå®çš„èµ„æºè¯·æ±‚ã€‚å¦‚æœ nginx æ²¡æœ‰åŒ¹é…å¾—åˆ°å½“å‰çš„ url ï¼Œå°±ä¼šå‡ºç° 404 çš„é¡µé¢ã€‚</p>
</li>
<li>
<p>åœ¨ä½¿ç”¨ history æ¨¡å¼æ—¶ï¼Œéœ€è¦<strong>é€šè¿‡æœåŠ¡ç«¯æ”¯æŒå…è®¸åœ°å€å¯è®¿é—®</strong>ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œå°±å¾ˆå®¹æ˜“å¯¼è‡´å‡ºç° 404 çš„å±€é¢ã€‚</p>
</li>
<li>
<p>æ”¹å˜urlï¼š history æä¾›äº† pushState å’Œ replaceState ä¸¤ä¸ªæ–¹æ³•æ¥è®°å½•è·¯ç”±çŠ¶æ€ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åªæ”¹å˜ URL ä¸ä¼šå¼•èµ·é¡µé¢åˆ·æ–°ã€‚</p>
</li>
<li>
<p>ç›‘å¬urlå˜åŒ–ï¼šé€šè¿‡ onpopstate äº‹ä»¶ç›‘å¬historyå˜åŒ–ï¼Œåœ¨ç‚¹å‡»æµè§ˆå™¨çš„å‰è¿›æˆ–è€…åé€€åŠŸèƒ½æ—¶è§¦å‘ï¼Œåœ¨onpopstate äº‹ä»¶ä¸­æ ¹æ®çŠ¶æ€ä¿¡æ¯åŠ è½½å¯¹åº”çš„é¡µé¢å†…å®¹ã€‚</p>
</li>
</ul>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code>history<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/b'</span><span class="token punctuation">)</span> <span class="token comment">// æ›¿æ¢è·¯ç”±</span>
history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/a'</span><span class="token punctuation">)</span> <span class="token comment">// è·¯ç”±å‹æ ˆï¼Œè®°å½•æµè§ˆå™¨çš„å†å²æ ˆ ä¸åˆ·æ–°é¡µé¢</span>
history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// è¿”å›</span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// å‰è¿›</span>
history<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// åé€€2æ¬¡</span>

window<span class="token punctuation">.</span><span class="token function-variable function">onpopstate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æ ¹æ®å½“å‰ URL åŠ è½½å¯¹åº”é¡µé¢</span>
  <span class="token function">loadPage</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>history.pushState ä¿®æ”¹æµè§ˆå™¨åœ°å€ï¼Œè€Œé¡µé¢çš„åŠ è½½æ˜¯é€šè¿‡ onpopstate äº‹ä»¶ç›‘å¬å®ç°ï¼ŒåŠ è½½å¯¹åº”çš„é¡µé¢å†…å®¹ï¼Œå®Œæˆé¡µé¢æ›´æ–°ã€‚</p>
<p>onpopstate äº‹ä»¶æ˜¯æµè§ˆå™¨å†å²å¯¼èˆªçš„æ ¸å¿ƒäº‹ä»¶,å®ƒæ ‡è¯†äº†é¡µé¢çŠ¶æ€çš„å˜åŒ–æ—¶æœºã€‚é€šè¿‡ç›‘å¬è¿™ä¸ªæ—¶æœº,æ ¹æ®æœ€æ–°çš„çŠ¶æ€ä¿¡æ¯æ›´æ–°é¡µé¢</p>
<p>å½“ä½¿ç”¨ history.pushState() æˆ– history.replaceState() æ–¹æ³•ä¿®æ”¹æµè§ˆå™¨çš„å†å²è®°å½•æ—¶ï¼Œä¸ä¼šç›´æ¥è§¦å‘ onpopstate äº‹ä»¶ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¯ä»¥åœ¨è°ƒç”¨è¿™äº›æ–¹æ³•æ—¶å°†æ•°æ®å­˜å‚¨åœ¨å†å²è®°å½•æ¡ç›®çš„çŠ¶æ€å¯¹è±¡ä¸­ï¼Œ onpopstate äº‹ä»¶åœ¨å¤„ç†ç¨‹åºä¸­è®¿é—®è¯¥çŠ¶æ€å¯¹è±¡ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥åœ¨ä¸è§¦å‘ onpopstate äº‹ä»¶çš„æƒ…å†µä¸‹æ›´æ–°é¡µé¢å†…å®¹ï¼Œå¹¶è·å–åˆ°ç›¸åº”çš„çŠ¶æ€å€¼ã€‚</p>
<h4 id="history-æ¨¡å¼ä¸‹-404-é¡µé¢çš„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#history-æ¨¡å¼ä¸‹-404-é¡µé¢çš„å¤„ç†"><span>history æ¨¡å¼ä¸‹ 404 é¡µé¢çš„å¤„ç†</span></a></h4>
<p>åœ¨ history æ¨¡å¼ä¸‹ï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ ¹æ®è¯·æ±‚çš„è·¯å¾„è¿›è¡ŒåŒ¹é…ï¼š</p>
<p>å¦‚æœæœåŠ¡å™¨æ— æ³•æ‰¾åˆ°ä¸è¯·æ±‚è·¯å¾„åŒ¹é…çš„èµ„æºæˆ–è·¯ç”±å¤„ç†å™¨ï¼ŒæœåŠ¡å™¨å¯ä»¥è¿”å› /404 è·¯ç”±ï¼Œè·³è½¬åˆ°é¡¹ç›®ä¸­é…ç½®çš„ 404 é¡µé¢ï¼ŒæŒ‡ç¤ºè¯¥è·¯å¾„æœªæ‰¾åˆ°ã€‚</p>
<p>å¯¹äºä½¿ç”¨å†å²è·¯ç”±æ¨¡å¼çš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ï¼Œé€šå¸¸ä¼šåœ¨æœåŠ¡å™¨é…ç½®ä¸­æ·»åŠ ä¸€ä¸ªé€šé…ç¬¦è·¯ç”±ï¼Œå°†æ‰€æœ‰éé™æ€èµ„æºçš„è¯·æ±‚éƒ½é‡å®šå‘åˆ°ä¸»é¡µæˆ–ä¸€ä¸ªè‡ªå®šä¹‰çš„ 404 é¡µé¢ï¼Œä»¥ä¿è¯åœ¨å‰ç«¯å¤„ç†è·¯ç”±æ—¶ä¸ä¼šå‡ºç°çœŸæ­£çš„ 404 é”™è¯¯é¡µé¢ã€‚</p>
<p>åœ¨é¡¹ç›®ä¸­é…ç½®å¯¹åº”çš„  404 é¡µé¢:</p>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> publicRoutes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/404'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'src/views/404/index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="vue2-vue-router-3" tabindex="-1"><a class="header-anchor" href="#vue2-vue-router-3"><span>Vue2 | vue-router@3</span></a></h2>
<blockquote>
<p>å®‰è£…</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code>yarn add vue<span class="token operator">-</span>router@<span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote>
<p>æ–°å»ºæ–‡ä»¶ src/router/index.js</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> VueRouter <span class="token keyword">from</span> <span class="token string">'vue-router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'./views/Home.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> About <span class="token keyword">from</span> <span class="token string">'./views/About.vue'</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">'/home'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// è®¾ç½®æ ¹è·¯å¾„é‡å®šå‘åˆ° '/home'</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> Home <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> About <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ<code v-pre>redirect</code> å­—æ®µç”¨äºæŒ‡å®šé‡å®šå‘çš„è·¯å¾„ã€‚</p>
<blockquote>
<p>åœ¨å…¥å£æ–‡ä»¶æŒ‚åœ¨è·¯ç”±</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  router<span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=></span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="vue3-vue-router-4" tabindex="-1"><a class="header-anchor" href="#vue3-vue-router-4"><span>Vue3 | vue-router@4</span></a></h2>
<blockquote>
<p>å®‰è£…</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre v-pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> vue-router@4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote>
<p>æ–°å»ºæ–‡ä»¶ src/router/index.ts</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token comment">//1. å¯¼å…¥ç›¸å…³çš„ API</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span>createWebHistory<span class="token punctuation">,</span>RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> "vue<span class="token operator">-</span>router

<span class="token comment">// 2. å®šä¹‰è·¯ç”±ç»„ä»¶.</span>
<span class="token comment">// ä¹Ÿå¯ä»¥ä»å…¶ä»–æ–‡ä»¶å¯¼å…¥</span>
<span class="token keyword">const</span> <span class="token literal-property property">routes</span><span class="token operator">:</span>Array<span class="token operator">&lt;</span>RouterRecordRaw<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span><span class="token string">"/home/:id"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">"Home"</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'xxxx'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">'/home'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
<span class="token punctuation">]</span>

<span class="token comment">// 3. åˆ›å»ºè·¯ç”±å®ä¾‹å¹¶ä¼ é€’ `routes` é…ç½®</span>
<span class="token comment">// ä½ å¯ä»¥åœ¨è¿™é‡Œè¾“å…¥æ›´å¤šçš„é…ç½®ï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œ</span>
<span class="token comment">// æš‚æ—¶ä¿æŒç®€å•</span>


<span class="token comment">// vue2 mode history vue3 createWebHistory</span>
<span class="token comment">// history</span>
<span class="token comment">//</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// vue2 mode hash vue3 createWebHasHistory // è·¯å¾„ä¼šå¤šä¸€ä¸ª#/</span>
<span class="token comment">// location.hash</span>
<span class="token comment">//window.addEventListener('hashchange',()=> {})</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span><span class="token function">createWebbbHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>åœ¨ vue çš„å…¥å£æ–‡ä»¶è¿›è¡ŒæŒ‚åœ¨æ³¨å†Œ</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token comment">// å¼•å…¥åˆšåˆšåˆ›å»ºçš„router</span>

<span class="token comment">// 4. åˆ›å»ºå¹¶æŒ‚è½½æ ¹å®ä¾‹</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//ç¡®ä¿ _use_ è·¯ç”±å®ä¾‹ä½¿</span>
<span class="token comment">//æ•´ä¸ªåº”ç”¨æ”¯æŒè·¯ç”±ã€‚</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>å±•ç¤ºè·¯ç”±</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token comment">// 5. å±•ç¤º</span>
<span class="token operator">&lt;</span>router<span class="token operator">-</span>view<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>ç»„ä»¶å®ç°è·¯ç”±çš„è·³è½¬</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token comment">// 6. è·³è½¬</span>
<span class="token comment">// ç»„ä»¶è·³è½¬</span>
<span class="token comment">//replace ä¸ä¿ç•™å†å²è®°å½•</span>
<span class="token operator">&lt;</span>router<span class="token operator">-</span>link replace to<span class="token operator">=</span><span class="token string">''</span><span class="token operator">></span>
<span class="token comment">// é»˜è®¤ push</span>
<span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">'{name:"Home"}'</span><span class="token operator">></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>ç¼–ç¨‹å¼è·³è½¬</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="token comment">//useRoute å–å‚æ•°</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRouter<span class="token punctuation">,</span>useRoute<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token literal-property property">query</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token literal-property property">params</span><span class="token operator">:</span><span class="token string">""</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//å–å‚</span>
<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>
route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>å…¨å±€å‰ç½®å®ˆå«</p>
</blockquote>
<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span>from<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">{</span>
  to<span class="token punctuation">.</span>path
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span><span class="token keyword">from</span></span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">{</span>
  to<span class="token punctuation">.</span>path
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></template>


