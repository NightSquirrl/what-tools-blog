# 5.1 Transition·过渡

## 介绍

### Vue 提供了两个内置组件，实现基于状态变化的过渡和动画

- 和

###  会在一个元素或组件进入和离开 DOM 时应用动画， 会在一个元素或组件被插入到 v-for 列表中，或是被移动或从其中移除时应用动画

##  组件

###  是一个内置组件，意味着它在任意别的组件中都可以被使用。它可以在一般元素以及通过默认插槽传递的组件上应用进入和离开动画

### 进入或离开可以由以下其中一种触发

- 由 v-if 所带来的条件渲染

- 由 v-show 所带来的条件显示

- 由特殊元素  切换的动态组件

### 当一个  组件中的元素被插入或移除时，会发生下面这些事情：

- Vue 会自动检测目标元素是否应用了 CSS 过渡或动画。如果是，则一些 CSS 过渡类会在适当的时机被添加和移除

- 如果有作为监听器的 JavaScript 钩子，这些钩子函数会在适当时机被调用

- 如果没有探测到 CSS 过渡或动画、没有提供 JavaScript 钩子，那么 DOM 的插入、删除操作将在浏览器的下一个动画帧上执行

## 基于 CSS 的过渡

### 过渡 CSS 类

- 一共有 6 个应用于进入与离开过渡效果的 CSS 类

	- v-enter-from：进入动画的起始状态。这个 CSS 类在元素插入之前添加，在元素插入完成后的下一帧移除

	- v-enter-active：进入动画的生效状态，应用于整个进入动画阶段。这个 CSS 类在元素被插入之前被添加，在过渡/动画完成之后移除

	- v-enter-to：进入动画的结束状态。这个 CSS 类在元素插入完成后的下一帧被添加

	- v-leave-from：离开动画的起始状态，在离开过渡效果被触发时立即添加，在一帧后被移除

	- v-leave-active：离开动画的生效状态，应用于整个离开动画阶段。在离开过渡效果被触发时立即添加，在过渡/动画完成之后移除

	- v-leave-to：离开动画的结束状态。这个 CSS 类在一个离开动画被触发后的下一帧被添加

### 为过渡命名

- 可以通过一个 name prop 来声明一种过渡

- 对于一个有名字的过渡，它的过渡相关 CSS 类会以其名字而不是 v 作为前缀

	- *-enter-active 和 *-leave-active

### CSS 的 transition

-  一般都会搭配原生 CSS 过渡一起使用，这个 transition CSS 属性是一个简写形式，使我们可以一次定义一个过渡的各个方面，包括需要执行动画的属性、持续时间和速度曲线

### CSS 的 animation

- 原生 CSS 动画和 CSS trasition 的应用方式基本上是相同的，只有一点不同，那就是 *-enter-from 不是在元素插入后立即移除，而是在一个 animationend 事件触发时被移除

### 自定义过渡类

- 你也可以向  传递以下的 props 来指定自定义的过渡类：

	- enter-from-class
enter-active-class
enter-to-class
leave-from-class
leave-active-class
leave-to-class

- 你传入的这些类会覆盖相应阶段的默认类名。这个功能在你想要在 Vue 的动画机制下集成其他的第三方 CSS 动画库时非常有用，比如 Animate.css

### 同时使用 transition 和 animation

- Vue 需要附加事件侦听器，以便知道过渡何时结束。可以是 transitionend 或 animationend，这取决于你所应用的 CSS 规则。如果你仅仅使用二者其中之一，Vue 可以自动探测到正确的类型

- 然而在某些场景中，你或许想要在同一个元素上同时使用它们两个，举个例子，触发了一个 CSS 动画的同时，由于副作用触发了另一个 CSS 过渡。此时你需要显式地传入 type prop 来声明，告诉 Vue 需要关心哪种类型，传入的值是 animation 或 transition，如

### 深层级过渡与显式过渡时间

- 尽管过渡类仅能应用在  的直接子元素上，我们还是可以使用深层级的 CSS 选择器，使深层级的元素发生过渡

### 性能考量

- 你可能注意到我们上面例子中展示的动画所用到的属性大多是 transform 和 opacity 之类的。用这些属性制作动画非常高效

- 高效的原因是

	- 他们在动画过程中不会影响到 DOM 结构，因此每一个动画帧都不会触发昂贵的 CSS 布局重新计算

	- 大多数的现代浏览器都可以在执行 transform 动画时利用 GPU 进行硬件加速

## JavaScript 钩子

### 你可以通过监听  组件事件的方式在过渡过程中挂上钩子函数

-   

### 这些钩子可以与 CSS 过渡/动画结合使用，也可以单独使用

### 在使用仅由 JavaScript 执行的动画时，最好是添加一个 :css="false" prop。这显式地向 Vue 表明跳过 CSS 过渡的自动探测。除了性能稍好一些之外，还可以防止 CSS 规则意外地干扰过渡

## 其他

### 可重用过渡

- 得益于 Vue 的组件系统，过渡是可以被重用的。要创建一个可被重用的过渡，我们需要为  组件创建一个包装组件，并向内传入插槽内容

  <!-- MyTransition.vue -->
  <script>
  // JavaScript 钩子逻辑...
  </script>
  
  <template>
    <!-- 包装内置的 Transition 组件 -->
    <Transition
      name='my-transition'
      @enter='onEnter'
      @leave='onLeave'>
      <slot></slot> <!-- 向内传递插槽内容 -->
    </Transition>
  </template>
  
  <style>
  /*
    必要的 CSS...
    注意：避免在这里使用 <style scoped>
    因为那不会应用到插槽内容上
  */
  </style>
### 出现时过渡

- 如果你想在某个节点初次渲染时应用一个过渡效果，你可以添加 appear attribute

	-  ... 

### 元素间过渡

- 除了通过 v-if / v-show 切换一个元素，我们也可以通过 v-if / v-else / v-else-if 在几个组件间进行切换过

### 过渡模式

- 我们可能想要先执行离开动画，然后在其完成之后再执行元素的进入动画。手动编排这样的动画是非常复杂的，好在我们可以通过向  传入一个 mode prop 来实现这个行为，比如：...

### 组件间过渡

-  也可以用在动态组件之间

### 动态过渡

-  的 props (比如 name) 也可以是动态的！这让我们可以根据状态变化动态地应用不同类型的过渡，


![5.1Transition88858a9e299c13bd.png](https://img.picgo.net/2024/02/10/5.1Transition88858a9e299c13bd.png)