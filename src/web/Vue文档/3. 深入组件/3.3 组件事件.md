# 3.3 组件事件

## 触发与监听事件

### 在组件的模板表达式中，可以直接使用 `$emit `函数触发自定义事件

### 父组件可以通过 v-on (缩写为 @) 来监听事件

### 注意，我们触发了一个以 camelCase 形式命名的事件，但在父组件中可以使用 kebab-case 形式来监听

### 和原生 DOM 事件不太一样，组件触发的事件不会冒泡。你只能监听直接子组件触发的事件

## 事件参数

### 所有传入 `$emit() `的额外参数都会被直接传向监听器

### 举个例子，`$emit('foo', 1, 2, 3)` 触发后，监听器函数将会收到这三个参数值

## 声明触发的事件

### 组件要触发的事件可以显式地通过 `defineEmits() `宏来声明

-` const emit = defineEmits(['inFocus', 'submit'])`

### 如果你没有使用 ，则事件需要通过 emits 选项来定义，emit 函数也被暴露在` setup() `的上下文对象上

```js
export default {
  emits: [&#39;inFocus&#39;, &#39;submit&#39;],
  setup(props, ctx) {
    ctx.emit(&#39;submit&#39;)
  }
}
```
### 这个 emits 选项还支持对象语法，它允许我们对触发事件的参数进行验证

### 搭配  使用 TypeScript，也可以使用纯类型标注来声明触发的事件

### 如果一个原生事件的名字 (例如 click) 被定义在 emits 选项中，则监听器只会监听组件触发的 click 事件而不会再响应原生的 click 事件

## 事件校验

### 要为事件添加校验，那么事件可以被赋值为一个函数，接受的参数就是抛出事件时传入 emit 的内容，返回一个布尔值来表明事件是否合法

```vue
<script setup>
const emit = defineEmits({
  // 没有校验
  click: null,

  // 校验 submit 事件
  submit: ({ email, password }) => {
    if (email && password) {
      return true
    } else {
      console.warn(&#39;Invalid submit event payload!&#39;)
      return false
    }
  }
})

function submitForm(email, password) {
  emit(&#39;submit&#39;, { email, password })
}
</script>

```
## 配合 v-model 使用

### 自定义事件可以用来创建对应 v-model 的自定义输入


```html
<input v-model='searchText' />
和下面这段代码是等价的：

<input
  :value='searchText'
  @input='searchText = $event.target.value'
/>
```

### 当使用在一个组件上时，v-model 是这样做的

-  `searchText = newValue"/>`

- 为了使组件能像这样工作，内部的  组件必须

	- 绑定 value attribute 到 modelValue prop

	- 输入新的值时在 input 元素上触发` update:modelValue` 事件

### 另一种在组件内实现 v-model 的方式是使用一个可写的 computed property ，给出 getter 和 setter。get 方法需返回 modelValue property ，而 set 方法需触发相应的事件

### v-model 的参数

- 默认情况下，v-model 在组件上都是使用 modelValue 作为 prop，以 update:modelValue 作为对应的事件。我们可以通过给 v-model 指定一个参数来更改这些名字

### 多个 v-model 绑定

- 利用一个特定的 prop 和一个特定事件，可以在一个组件上创建多个 v-model 双向绑定

- 每一个 v-model 都会同步不同的 prop，而不需要在组件上写更多额外的选项

### 处理 v-model 修饰符

- 除了内置的修饰符，还可以自定义修饰符

- 给组件的 v-model 添加的修饰符，都可以通过 modelModifiers prop 在组件内访问到


![3.312d21f42c12766ac.png](https://img.picgo.net/2024/02/10/3.312d21f42c12766ac.png)