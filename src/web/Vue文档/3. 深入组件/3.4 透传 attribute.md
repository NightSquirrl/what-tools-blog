# 3.4 透传 attribute

## Attribute 继承

### “透传 attribute”的意思是 attribute 或者被传递给一个组件的 v-on 事件监听器，但并没有显式地声明在所接收组件的 props 或 emits 上

### 当一个组件以单个元素为根作渲染时，透传的 attribute 会自动添加到根元素的 attribute 中

### 对 class 和 style 的合并

- 如果一个子组件的根元素已经有了 class 或 style attribute，它会和从父组件上继承的值合并

### v-on 监听器继承

- 上述同样的规则也适用于 v-on 事件监听器

### 深层组件继承

- 如果一个组件在根节点上渲染另一个组件，此时父组件接收的透传 attribute 会直接传向子组件

## 禁用 Attribute 继承

### 如果你不想要一个组件自动地继承 attribute，你可以在组件选项中设置 `inheritAttrs: false`

### 如果你使用了 ，你需要一个额外的  块来书写这个选项声明

```vue

<script>
// 使用一个简单的 <script> to declare options
export default {
  inheritAttrs: false
}
</script>

<script setup>
// ...setup 部分逻辑
</script>
```

### 有几点需要注意：

- 和 props 有所不同，透传 attributes 在 JS 中保留了它们原始的大小写，所以像 `foo-bar` 这样的一个 attribute 需要通过 `$attrs['foo-bar'] `来访问

- 像 `@click `这样的一个 v-on 事件监听器将在此对象下被暴露为一个函数 `$attrs.onClick`

## 多根节点的 Attribute 继承

### 和单根节点组件有所不同，有着多个根节点的组件没有自动 attribute 透传行为。如果 $attrs 没有被显式绑定，将会抛出一个运行时警告

### 如果 $attrs 被显式绑定，则不会有警告

```html
<header>...</header>
<main v-bind='$attrs'>...</main>
<footer>...</footer>
```
## 在 JavaScript 中访问透传 Attributes

### 你可以在  中使用` useAttrs()` API 来访问一个组件的所有透传 attribute

```vue

<script setup>
import { useAttrs } from &#39;vue&#39;

const attrs = useAttrs()
</script>
```
### 如果没有使用 ，attrs 会作为 `setup() `上下文对象的一个属性暴露

```js
export default {
  setup(props, ctx) {
    // 透传 attribute 被暴露为 ctx.attrs
    console.log(ctx.attrs)
  }
}
```

### 需要注意的是，虽然这里的 attrs 对象总是反映为最新的透传 attribute，但它并不是响应式的 (考虑到性能因素)。你不能通过侦听器去监听它的变化。如果你需要响应性，可以使用 prop。或者你也可以使用 `onUpdated() `使得在每次更新时结合最新的 attrs 执行副作用


![3.4-attributecb12f8446b74d02e.png](https://img.picgo.net/2024/02/10/3.4-attributecb12f8446b74d02e.png)