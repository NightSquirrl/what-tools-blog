# 3.2 Props

## Props 声明

### 组件需要显式声明 props，这样 Vue 才能知道外部传入的哪些是 props，哪些是透传 attribute

### 在没有使用  的组件中，props 需使用 props 选项来定义

### 请注意，传给 `defineProps()` 的参数和提供给 props 选项的值是相同的，两种声明方式背后其实使用的都是 props 选项

### 除了使用字符串数组来声明 props 外，还可以使用对象的形式

- 对于以对象形式声明中的每个属性，key 是 prop 的名称，而值应该是预期类型的构造函数

### 如果你正在搭配 TypeScript 使用 ，也可以使用类型标注来声明 props

## 传递 props 的细节

### Prop 名字格式

- 如果 prop 的名字很长，应使用 camelCase 形式

### 静态 vs. 动态 Props

- 使用 v-bind 或缩写 : 所动态绑定的 props 值称为动态Props

### 传递不同的值类型

- 可以任何类型的值作为一个 prop

### 使用一个对象绑定多个 prop

- 如果你想要将一个对象的所有属性都当作 prop 传入，你可以使用没有参数的 v-bind

  `<BlogPost v-bind='post' />`
## 单向数据流

### 所有的 prop 都遵循着单向绑定原则，prop 因父组件的更新而变化，自然地将新的状态向下流往子组件，而不会逆向传递。这避免了子组件意外修改了父组件的状态

### 另外，每次父组件更新后，所有的子组件中的 props 都会被更新到最新值，这意味着你不应该在子组件中去更改一个 prop。若你这么做了，Vue 会在控制台上向你抛出警告

### 想要更改 prop 通常都符合以下两种场景：

- prop 被用于传入初始值；而子组件想在之后将其作为一个局部数据属性

	- 在这种情况下，最好是新定义一个局部数据属性，从 props 上取初始值即可

- prop 以原始的形式传入，但还需作转换

	- 在这种情况中，最好是基于该 prop 值定义一个计算属性

### 更改对象 / 数组类型的 prop

- 当对象或数组作为 prop 被传入时，虽然子组件无法更改 prop 绑定，但仍然可以更改对象或数组内部的值。这是因为 JavaScript 的对象和数组是按引用传递，而对 Vue 来说，阻止这样的改变不但非常昂贵，也不合理

- 这种更改的主要缺陷是它允许了子组件以某种不明显的方式影响了父组件的状态，可能会使数据流在将来变得更难以推理。按照最佳实践来讲，你应该避免这样的更改，除非父子组件在设计上耦合得非常紧密。在大多数的用例场景中，子组件都应该抛出一个事件来通知父组件做出改变

## Prop 校验

### 组件可以更细致地指定对其 props 的需求，比如类型限制，如果并没有指定要求，Vue 会在浏览器的 JavaScript 控制台中抛出警告来提醒你

### 要描述对 prop 的校验，你可以向 `defineProps() `宏提供一个带有 prop 校验的对象

### 细节补充

- 所有 props 默认都是可选的，除非声明了` required: true`

- 未传递的 prop 会有一个缺省值` undefined`

- 如果声明了 `default` 值，那么在 prop 的值被解析为 undefined 时，无论 prop 是未被传递还是显式指明的 undefined，都会改为 default 值

### 当 prop 的校验失败后，Vue 会抛出一个控制台警告 (在开发模式下)

### 运行时类型检查

- type 可以是下列这些原生构造器：`String、Number、Boolean、Array、Object、Date、Function、Symbol`

- 另外，type 也可以是自定义的类或构造函数，可以通过` instanceof `来检查、断言

## Boolean 类型转换

### 为了更贴近原生` boolean attributes` 的行为，声明为` Boolean `类型的 `props` 有特别的类型转换规则

以带有如下声明的 `<MyComponent> `组件为例：

```js
defineProps({
  disabled: Boolean
})
```
该组件可以被这样使用：

<!-- 等同于传入 :disabled='true' -->
`<MyComponent disabled />`

<!-- 等同于传入 :disabled='false' -->
`<MyComponent />`
### 当需要一个 prop 在声明时允许多种类型时，无论声明类型的顺序如何，Boolean 类型的特殊转换规则都会被应用


![3.2Props3ecee771f016a969.png](https://img.picgo.net/2024/02/10/3.2Props3ecee771f016a969.png)